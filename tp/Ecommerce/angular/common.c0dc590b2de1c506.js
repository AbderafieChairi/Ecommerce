"use strict";(self.webpackChunkEcommerce=self.webpackChunkEcommerce||[]).push([[592],{892:(E,l,o)=>{o.d(l,{e:()=>g});var i=o(5861),a=o(7323),h=o(7946),r=o(1566),_=o(4650),d=o(3060);let g=(()=>{class s{constructor(t,e){this.auth=t,this.router=e}getCurrentUser(){return this.auth.currentUser}isAuth(){return null!=this.auth.currentUser}normalSignIn(t,e){var n=this;return(0,i.Z)(function*(){return(0,a.e5)(n.auth,t,e).then(u=>{console.log("signInWithEmailAndPassword"),console.log(u.user.uid.toString()),(0,r.QT)((0,r.JU)((0,r.ad)(),"user",u.user.uid.toString())).then(c=>{c.exists()&&(localStorage.setItem("user_id",c.id),n.router.navigate(["store","profile"]))})}).catch(u=>{console.log(u.code),"auth/user-not-found"==u.code&&(0,a.Xb)(n.auth,t,e).then(c=>n.router.navigate(["user","signup"]))})})()}getUser(){return(0,i.Z)(function*(){const t=localStorage.getItem("user_id");return null==t?{}:(0,r.QT)((0,r.JU)((0,r.ad)(),"user",t||"")).then(e=>({...e.data(),id:e.id})).then(e=>(console.log(e),e))})()}createUser(t){var e=this;return(0,i.Z)(function*(){const n=t;n.email=e.auth.currentUser?.email,n.createdAt=(new Date).toLocaleDateString(),(0,r.pl)((0,r.JU)((0,r.ad)(),"user",e.auth.currentUser?.uid||""),n).then(u=>{n.id=e.auth.currentUser?.uid,localStorage.setItem("user_id",n.id),e.router.navigate(["store","profile"])})})()}googleSignIn(){var t=this;return(0,i.Z)(function*(){const e=new h.hJ,n=yield(0,a.rh)(t.auth,e);(0,r.PL)((0,r.IO)((0,r.hJ)((0,r.ad)(),"user"),(0,r.ar)("id","==",n.user.uid.toString()))).then(u=>{u.empty?t.router.navigate(["user","signup"]):(localStorage.setItem("user_id",u.docs[0].id),t.router.navigate(["store","profile"]))})})()}logout(){return localStorage.removeItem("user_id"),(0,a.w7)(this.auth)}}return s.\u0275fac=function(t){return new(t||s)(_.LFG(a.gx),_.LFG(d.F0))},s.\u0275prov=_.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()}}]);